<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: CanCan::ActiveRecordAdditions::ClassMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">CanCan::ActiveRecordAdditions::ClassMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/vendor/plugins/cancan/lib/cancan/active_record_additions_rb.html">
                vendor/plugins/cancan/lib/cancan/active_record_additions.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000015">accessible_by</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="#M000015" class="method-signature">
          <span class="method-name">accessible_by</span><span class="method-args">(ability, action = :read)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a scope which fetches only the records that the passed ability can
perform a given action on. The action defaults to :read. This is usually
called from a controller and passed the <tt>current_ability</tt>.
</p>
<pre>
  @articles = Article.accessible_by(current_ability)
</pre>
<p>
Here only the articles which the user is able to read will be returned. If
the user does not have permission to read any articles then an empty result
is returned. Since this is a scope it can be combined with any other scopes
or pagination.
</p>
<p>
An alternative action can optionally be passed as a second argument.
</p>
<pre>
  @articles = Article.accessible_by(current_ability, :update)
</pre>
<p>
Here only the articles which the user can update are returned. This
internally uses Ability#conditions method, see that for more information.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000015-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000015-source">
<pre>
    <span class="ruby-comment cmt"># File vendor/plugins/cancan/lib/cancan/active_record_additions.rb, line 22</span>
22:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">accessible_by</span>(<span class="ruby-identifier">ability</span>, <span class="ruby-identifier">action</span> = <span class="ruby-identifier">:read</span>)
23:         <span class="ruby-identifier">query</span> = <span class="ruby-identifier">ability</span>.<span class="ruby-identifier">query</span>(<span class="ruby-identifier">action</span>, <span class="ruby-keyword kw">self</span>)
24:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:where</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:joins</span>)
25:           <span class="ruby-identifier">where</span>(<span class="ruby-identifier">query</span>.<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">joins</span>(<span class="ruby-identifier">query</span>.<span class="ruby-identifier">joins</span>)
26:         <span class="ruby-keyword kw">else</span>
27:           <span class="ruby-identifier">scoped</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">query</span>.<span class="ruby-identifier">conditions</span>, <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">query</span>.<span class="ruby-identifier">joins</span>)
28:         <span class="ruby-keyword kw">end</span>
29:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>